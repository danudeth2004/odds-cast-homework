<%# app/views/admin/articles/show.html.erb  (หรือย้ายไป shared แล้ว render ก็ได้) %>
<% admin_view = request.path.start_with?("/admin") %>
<% content_for :title, (admin_view ? "Article Detail" : @article.title) %>

<div class="max-w-3xl w-full mx-auto flex flex-col gap-6">
  <% if admin_view && notice.present? %>
    <p id="notice" class="rounded-lg bg-green-500/10 text-green-300 border border-green-400/20 px-4 py-2 text-sm font-medium">
      <%= notice %>
    </p>
  <% end %>

  <!-- Header -->
  <div class="flex items-start justify-between gap-4">
    <div class="min-w-0">
      <h1 class="font-bold text-3xl md:text-4xl text-white break-words"><%= @article.title %></h1>

      <% if admin_view %>
        <%# Status badge mapping %>
        <% status = @article.status.to_s %>
        <% badge_classes = case status
          when "draft"              then "bg-slate-700/80 text-slate-200 border-slate-500/50"
          when "waiting_for_review" then "bg-amber-500/20 text-amber-300 border-amber-400/30"
          when "published"          then "bg-emerald-500/20 text-emerald-300 border-emerald-400/30"
          else                           "bg-slate-700 text-slate-200 border-slate-500/50"
        end %>

        <div class="mt-3 flex flex-wrap items-center gap-3 text-sm text-slate-400">
          <span class="inline-flex items-center gap-1.5 rounded-full px-2.5 py-1 text-[11px] font-semibold border <%= badge_classes %>">
            <%= status.humanize %>
          </span>
          <span>ID: <%= @article.id %></span>
          <span>Created: <%= l(@article.created_at, format: :long) rescue @article.created_at %></span>
          <span>Updated: <%= l(@article.updated_at, format: :long) rescue @article.updated_at %></span>
        </div>
      <% end %>
    </div>

    <!-- Actions -->
    <div class="flex flex-shrink-0 items-center gap-2">
      <% back_path = admin_view ? admin_articles_path : articles_path %>
      <%= link_to back_path,
          class: "inline-flex items-center gap-1 rounded-xl px-3.5 py-2.5
                  bg-slate-700 hover:bg-slate-600 text-slate-100 text-sm font-medium
                  shadow-sm shadow-black/20 transition" do %>
        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
        </svg>
        <span>Back</span>
      <% end %>

      <% if admin_view %>
        <% if @article.status == "waiting_for_review" %>
          <%= link_to edit_admin_article_path(@article),
              class: "inline-flex items-center gap-1 rounded-xl px-3.5 py-2.5
                      bg-amber-600 hover:bg-amber-500 text-white text-sm font-medium
                      shadow-sm shadow-amber-900/30 transition
                      focus-visible:outline-none focus-visible:ring-2
                      focus-visible:ring-amber-400/70 focus-visible:ring-offset-2
                      focus-visible:ring-offset-slate-900" do %>
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 20h9M12 4h9M4 9h16M4 15h16"/>
            </svg>
            <span>Review</span>
          <% end %>
        <% else %>
          <%= link_to edit_admin_article_path(@article),
              class: "inline-flex items-center gap-1 rounded-xl px-3.5 py-2.5
                      bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium
                      shadow-sm shadow-indigo-900/30 transition" do %>
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M16.862 3.487a2.1 2.1 0 012.97 2.97L9.75 16.54l-3.9.93.93-3.9 10.082-10.082z"/>
              <path stroke-linecap="round" stroke-linejoin="round"
                    d="M19 14v4.2A1.8 1.8 0 0117.2 20H6.8A1.8 1.8 0 015 18.2V7.8A1.8 1.8 0 016.8 6H11"/>
            </svg>
            <span>Edit</span>
          <% end %>
        <% end %>

        <%= button_to [:admin, @article], method: :delete,
            data: { turbo_confirm: "Delete “#{@article.title}” ?" },
            class: "inline-flex items-center gap-1 rounded-xl px-3.5 py-2.5
                    bg-red-600 hover:bg-red-500 text-white text-sm font-medium
                    shadow-sm shadow-red-900/30 transition" do %>
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 6h18M8 6V4.8A1.8 1.8 0 019.8 3h4.4A1.8 1.8 0 0116 4.8V6M6 6l1.2 13.2A1.8 1.8 0 009 21h6a1.8 1.8 0 001.8-1.8L18 6"/>
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 10v7M14 10v7"/>
          </svg>
          <span>Delete</span>
        <% end %>
      <% end %>
    </div>
  </div>

  <!-- Content -->
  <section class="rounded-2xl border border-white/10 bg-slate-800/60 p-6">
    <%# public: ไม่มี heading; admin: มี heading %>
    <% if admin_view %>
      <h2 class="text-lg font-semibold text-white mb-3">Description</h2>
    <% end %>
    <div class="text-slate-300 leading-relaxed break-words whitespace-pre-line">
      <%= @article.description %>
    </div>

    <% if admin_view && @article.respond_to?(:content) && @article.content.present? %>
      <hr class="my-6 border-white/10">
      <h2 class="text-lg font-semibold text-white mb-3">Content</h2>
      <div class="text-slate-300 leading-relaxed break-words whitespace-pre-line">
        <%= @article.content %>
      </div>
    <% end %>
  </section>
</div>
