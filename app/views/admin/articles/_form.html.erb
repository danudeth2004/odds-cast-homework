<%= form_with(model: [:admin, article],
              data: { controller: "article",
                "article-save-url-value": article.persisted? ? admin_article_path(article) : "#",
                "article-submit-url-value": article.persisted? ? submit_admin_article_path(article) : "#", 
                "article-approve-url-value": article.persisted? ? approve_admin_article_path(article) : "#", 
                "article-reject-url-value": article.persisted? ? reject_admin_article_path(article) : "#", 
                "article-target": "form" }, local: true) do |form| %>

  <!-- Title -->
  <div class="my-5">
    <%= form.label :title, class: "block text-sm font-medium text-slate-200" %>
    <%= form.text_field :title,
          class: "mt-2 block w-full rounded-xl border border-white/10 bg-slate-800/50 text-slate-100 shadow-sm px-3 py-2
                  focus:border-sky-500 focus:ring focus:ring-sky-500/30 focus:outline-none
                  #{ 'bg-slate-700/50 text-slate-400 cursor-not-allowed' if ['waiting_for_review', 'published'].include?(article.status) }",
          readonly: ["waiting_for_review", "published"].include?(article.status) %>
  </div>

  <!-- Description -->
  <div class="my-5">
    <%= form.label :description, class: "block text-sm font-medium text-slate-200" %>
    <%= form.text_area :description, rows: 4,
          class: "mt-2 block w-full rounded-xl border border-white/10 bg-slate-800/50 text-slate-100 shadow-sm px-3 py-2
                  focus:border-sky-500 focus:ring focus:ring-sky-500/30 focus:outline-none
                  #{ 'bg-slate-700/50 text-slate-400 cursor-not-allowed' if ['waiting_for_review', 'published'].include?(article.status) }",
          readonly: ["waiting_for_review", "published"].include?(article.status) %>
  </div>

  <!-- Action buttons -->
  <div class="mt-6 flex items-center justify-between gap-3">
    <!-- Back -->
    <%= link_to [:admin, @article],
        class: "inline-flex items-center gap-1 rounded-xl px-4 py-2.5
                bg-slate-700 hover:bg-slate-600 text-slate-100 text-sm font-medium
                shadow-sm shadow-black/20 transition" do %>
      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
      </svg>
      <span>Back</span>
    <% end %>

    <div class="flex items-center gap-3">
      <% if article.persisted? %>
        <% case article.status %>
        <% when "draft" %>
          <!-- Save draft-->
          <%= button_tag type: "button",
                class: "inline-flex items-center gap-1 rounded-xl px-4 py-2.5
                        bg-slate-700 hover:bg-slate-600 text-slate-100 text-sm font-medium
                        shadow-sm shadow-black/20 transition",
                data: { action: "click->article#save" } do %>
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
            </svg>
            <span>Save draft</span>
          <% end %>

          <!-- Submit -->
          <%= button_tag type: "button",
                class: "inline-flex items-center justify-center gap-1 rounded-xl px-4 py-2.5
                        bg-amber-600 hover:bg-amber-500 text-white text-sm font-medium
                        shadow-sm shadow-amber-900/30 transition",
                data: { action: "click->article#submit" } do %>
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14M12 5l7 7-7 7"/>
            </svg>
            <span>Submit for Review</span>
          <% end %>

        <% when "waiting_for_review" %>
          <%= button_tag type: "button",
                class: "inline-flex items-center justify-center rounded-xl p-2.5
                        bg-emerald-600 hover:bg-emerald-500 text-white
                        shadow-sm shadow-emerald-900/30 transition",
                title: "Publish",
                data: { action: "click->article#approve" } do %>
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
            </svg>
          <% end %>

          <%= button_tag type: "button",
                class: "inline-flex items-center justify-center rounded-xl p-2.5
                        bg-red-600 hover:bg-red-500 text-white
                        shadow-sm shadow-red-900/30 transition",
                title: "Reject",
                data: { action: "click->article#reject" } do %>
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          <% end %>
        <% when "published" %>
          <%= button_tag type: "button",
                class: "inline-flex items-center gap-1 rounded-xl px-4 py-2.5
                        bg-slate-600 hover:bg-slate-500 text-slate-100 text-sm font-medium
                        shadow-sm shadow-black/20 transition",
                data: { action: "click->article#reject" } do %>
            <svg class="tw-tab__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8"
            d="M16.862 3.487a2.1 2.1 0 0 1 2.97 2.97L9.75 16.54l-3.9.93.93-3.9 10.082-10.082z"/>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8"
            d="M19 14v4.2A1.8 1.8 0 0 1 17.2 20H6.8A1.8 1.8 0 0 1 5 18.2V7.8A1.8 1.8 0 0 1 6.8 6H11"/>
        </svg>
            <span>Revert to Draft</span>
          <% end %>

        <% end %>

      <% else %>
        <%= button_tag type: "submit", name: "status_type", value: "draft",
              class: "inline-flex items-center gap-1 rounded-xl px-4 py-2.5
                      bg-slate-700 hover:bg-slate-600 text-slate-100 text-sm font-medium
                      shadow-sm shadow-black/20 transition" do %>
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
          </svg>
          <span>Save draft</span>
        <% end %>

        <%= button_tag type: "submit", name: "status_type", value: "waiting_for_review",
              class: "inline-flex items-center gap-1 rounded-xl px-4 py-2.5
                      bg-amber-600 hover:bg-amber-500 text-white text-sm font-medium
                      shadow-sm shadow-amber-900/30 transition" do %>
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
          <span>Submit for Review</span>
        <% end %>
      <% end %>
    </div>
  </div>
<% end %>
