<%= form_with(model: [:admin, article],
              data: { controller: "article",
                "article-save-url-value": article.persisted? ? admin_article_path(article) : "#",
                "article-submit-url-value": article.persisted? ? submit_admin_article_path(article) : "#", 
                "article-approve-url-value": article.persisted? ? approve_admin_article_path(article) : "#", 
                "article-reject-url-value": article.persisted? ? reject_admin_article_path(article) : "#", 
                "article-target": "form" }, local: true) do |form| %>

  <div class="my-5">
    <%= form.label :title %>
    <%= form.text_field :title,
          class: "block shadow-sm rounded-md border px-3 py-2 mt-2 w-full #{ 'bg-gray-100 text-gray-500 cursor-not-allowed' if ['waiting_for_review', 'published'].include?(article.status) }",
          readonly: ["waiting_for_review", "published"].include?(article.status) %>
  </div>

  <div class="my-5">
    <%= form.label :description %>
    <%= form.text_area :description, rows: 4,
          class: "block shadow-sm rounded-md border px-3 py-2 mt-2 w-full #{ 'bg-gray-100 text-gray-500 cursor-not-allowed' if ['waiting_for_review', 'published'].include?(article.status) }",
          readonly: ["waiting_for_review", "published"].include?(article.status) %>
  </div>

  <% if article.persisted? %>
    <% case article.status %>
    <% when "draft" %>
      <%= button_tag "Save draft", type: "button",
            class: "w-full sm:w-auto rounded-md px-3.5 py-2.5 bg-blue-600 hover:bg-blue-500 text-white inline-block font-medium cursor-pointer",
            data: { action: "click->article#save" } %>
      <%= button_tag "Review", type: "button",
            class: "w-full sm:w-auto rounded-md px-3.5 py-2.5 bg-green-600 hover:bg-green-500 text-white inline-block font-medium cursor-pointer",
            data: { action: "click->article#submit" } %>
    <% when "waiting_for_review" %>
      <%= button_tag "Publish", type: "button",
            class: "w-full sm:w-auto rounded-md px-3.5 py-2.5 bg-blue-600 hover:bg-blue-500 text-white inline-block font-medium cursor-pointer",
            data: { action: "click->article#approve" } %>
      <%= button_tag "Reject", type: "button",
            class: "w-full sm:w-auto rounded-md px-3.5 py-2.5 bg-red-600 hover:bg-red-500 text-white inline-block font-medium cursor-pointer",
            data: { action: "click->article#reject" } %>
    <% when "published" %>
      <%= button_tag "Back to Draft", type: "button",
            class: "w-full sm:w-auto rounded-md px-3.5 py-2.5 bg-blue-600 hover:bg-blue-500 text-white inline-block font-medium cursor-pointer",
            data: { action: "click->article#reject" } %>
    <% end %>
  <% else %>
    <%= button_tag "Save draft", name: "status_type", value: "draft", class: "w-full sm:w-auto rounded-md px-3.5 py-2.5 bg-blue-600 hover:bg-blue-500 text-white inline-block font-medium cursor-pointer" %>
    <%= button_tag "Submit for Review", name: "status_type", value: "waiting_for_review", class: "w-full sm:w-auto rounded-md px-3.5 py-2.5 bg-green-600 hover:bg-green-500 text-white inline-block font-medium cursor-pointer" %>
  <% end %>
<% end %>
